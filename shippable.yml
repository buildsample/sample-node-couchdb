# Language setting
language: node_js

# Version number
node_js:
  - 0.10.31
 # - 0.11

# CouchDB binds to 127.0.0.1 by default
services:
  - couchdb

# The path for Xunit to output test reports
env:
  global:
  - XUNIT_FILE=shippable/testresults/result.xml
  - secure: pHx5dR/qpqAnTJo5GCm7FUzD5YVvmB+y5YmcrGK09TQtBsi3d+p9dyf6V0DnsuJy8gIDS71YnDjbnycdqnKgGevjul4fQkWF+T52DvF49q5PbkDkqAbzo2HIr2VIOboutuhSy+FwlQb7aGjq9/AHTKlQSubFCjqvouB1uw7R9thsvUBnW/Ea+h39W4+0mzpLp9k6tmCAGkj/tGEMXgiZQvjX/3wvM45F3x5eGl+2bkxRELSr51NJAcBYC8+6k5svo6utNKQFhBE2HxFwpkJsJEh4oSOMf0GqWs0Vea7RRlA3lLJ116gQNKh7GuKLgxXN38w+GXPU8beIRZfHTpCHNw==
  

# Create directories for test and coverage reports
before_script:
  - mkdir -p shippable/testresults
  - mkdir -p shippable/codecoverage

# Running the tests with grunt
script:
  - grunt
  - echo $COMPARE_URL
  - echo $LAST_SUCCESSFUL_BUILD_TIMESTAMP

# Tell istanbul to generate a coverage report
after_script:
  - echo $test 
  - ./node_modules/.bin/istanbul cover grunt -- -u tdd
  - ./node_modules/.bin/istanbul report cobertura --dir  shippable/codecoverage/
archive: true
#cache: true
